<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>U1.3 Squeeze Theorem | AP Calculus BC</title>

    <!-- KaTeX for mathematical notation -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>

    <!-- Plotly.js for graphs -->
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>

    <!-- Math.js for calculations -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/12.2.1/math.min.js"></script>

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Custom Annotation System -->
    <link rel="stylesheet" href="lib/annotation.css">

    <style>
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f8f9fa;
            --bg-tertiary: #e9ecef;
            --text-primary: #212529;
            --text-secondary: #495057;
            --text-muted: #6c757d;
            --accent-primary: #4361ee;
            --accent-secondary: #3f37c9;
            --accent-success: #10b981;
            --accent-warning: #f59e0b;
            --accent-danger: #ef4444;
            --border-color: #dee2e6;
            --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
            --shadow-md: 0 4px 6px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 15px rgba(0,0,0,0.1);
            --radius-sm: 4px;
            --radius-md: 8px;
            --radius-lg: 12px;
            --font-mono: 'SF Mono', 'Consolas', 'Liberation Mono', monospace;
        }

        [data-theme="dark"] {
            --bg-primary: #1a1a2e;
            --bg-secondary: #16213e;
            --bg-tertiary: #0f3460;
            --text-primary: #eef0f2;
            --text-secondary: #c9ccd1;
            --text-muted: #8b8f94;
            --border-color: #2d3748;
            --shadow-sm: 0 1px 2px rgba(0,0,0,0.3);
            --shadow-md: 0 4px 6px rgba(0,0,0,0.4);
            --shadow-lg: 0 10px 15px rgba(0,0,0,0.5);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            transition: background 0.3s, color 0.3s;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
            padding: 40px 20px;
            margin-bottom: 30px;
            border-radius: var(--radius-lg);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
        }

        .unit-badge {
            display: inline-block;
            background: rgba(255,255,255,0.2);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            margin-bottom: 10px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .header-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 15px;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .freq-badge {
            background: rgba(255,255,255,0.25);
            padding: 2px 10px;
            border-radius: 12px;
            font-weight: 600;
        }

        .difficulty-badge-header {
            background: rgba(239, 68, 68, 0.3);
            padding: 2px 10px;
            border-radius: 12px;
            font-weight: 600;
        }

        /* Theme Toggle */
        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 50%;
            width: 45px;
            height: 45px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            z-index: 1000;
            transition: all 0.3s;
        }

        .theme-toggle:hover {
            transform: scale(1.1);
        }

        /* Navigation */
        .nav-tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            background: var(--bg-secondary);
            padding: 10px;
            border-radius: var(--radius-lg);
            margin-bottom: 30px;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-tab {
            padding: 10px 20px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            cursor: pointer;
            border-radius: var(--radius-md);
            font-size: 0.95rem;
            font-weight: 500;
            transition: all 0.3s;
        }

        .nav-tab:hover {
            background: var(--bg-tertiary);
        }

        .nav-tab.active {
            background: var(--accent-primary);
            color: white;
        }

        /* Sections */
        .section {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-title {
            font-size: 1.8rem;
            margin-bottom: 20px;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title::before {
            content: '';
            width: 4px;
            height: 30px;
            background: var(--accent-primary);
            border-radius: 2px;
        }

        /* Cards */
        .card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: 25px;
            margin-bottom: 20px;
        }

        .card-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--text-primary);
        }

        /* Key Points */
        .key-point {
            display: flex;
            gap: 15px;
            padding: 15px;
            background: var(--bg-tertiary);
            border-radius: var(--radius-md);
            margin-bottom: 10px;
            border-left: 4px solid var(--accent-primary);
        }

        .key-point-number {
            background: var(--accent-primary);
            color: white;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.85rem;
            flex-shrink: 0;
        }

        /* Prerequisites */
        .prereq-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            margin-bottom: 15px;
            overflow: hidden;
        }

        .prereq-header {
            padding: 15px 20px;
            background: var(--bg-tertiary);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .prereq-header:hover {
            background: var(--border-color);
        }

        .prereq-title {
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .prereq-badge {
            font-size: 0.75rem;
            padding: 2px 8px;
            border-radius: 10px;
            background: var(--accent-warning);
            color: white;
        }

        .prereq-badge.internal {
            background: var(--accent-primary);
        }

        .prereq-content {
            padding: 20px;
            display: none;
        }

        .prereq-content.active {
            display: block;
        }

        .prereq-toggle {
            font-size: 1.2rem;
            transition: transform 0.3s;
        }

        .prereq-card.open .prereq-toggle {
            transform: rotate(180deg);
        }

        /* Problem Types */
        .problem-type {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            margin-bottom: 15px;
            overflow: hidden;
        }

        .problem-type-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            cursor: pointer;
            user-select: none;
            flex-wrap: wrap;
            gap: 10px;
        }

        .problem-type-header:hover {
            background: var(--bg-tertiary);
        }

        .problem-type-title {
            font-weight: 600;
            font-size: 1.1rem;
        }

        .toggle-icon {
            font-size: 0.9rem;
            transition: transform 0.3s ease;
            margin-left: auto;
            padding-left: 15px;
        }

        .problem-type.collapsed .toggle-icon {
            transform: rotate(-90deg);
        }

        .problem-type-content {
            overflow: hidden;
            transition: max-height 0.3s ease, opacity 0.3s ease;
            max-height: 5000px;
            opacity: 1;
            padding: 0 20px 20px;
        }

        .problem-type.collapsed .problem-type-content {
            max-height: 0;
            opacity: 0;
            padding: 0 20px;
        }

        .difficulty-badge {
            font-size: 0.75rem;
            padding: 2px 10px;
            border-radius: 10px;
            font-weight: 500;
        }

        .difficulty-badge.easy { background: #d1fae5; color: #065f46; }
        .difficulty-badge.medium { background: #fef3c7; color: #92400e; }
        .difficulty-badge.hard { background: #fee2e2; color: #991b1b; }

        [data-theme="dark"] .difficulty-badge.easy { background: #065f46; color: #d1fae5; }
        [data-theme="dark"] .difficulty-badge.medium { background: #92400e; color: #fef3c7; }
        [data-theme="dark"] .difficulty-badge.hard { background: #991b1b; color: #fee2e2; }

        /* Pattern Box */
        .pattern-box {
            background: linear-gradient(135deg, var(--bg-tertiary), var(--bg-secondary));
            border: 2px dashed var(--accent-primary);
            border-radius: var(--radius-md);
            padding: 20px;
            margin: 15px 0;
        }

        .pattern-label {
            font-size: 0.8rem;
            text-transform: uppercase;
            color: var(--accent-primary);
            font-weight: 600;
            margin-bottom: 8px;
        }

        /* Theorem Box */
        .theorem-box {
            background: linear-gradient(135deg, rgba(67, 97, 238, 0.1), rgba(63, 55, 201, 0.1));
            border: 2px solid var(--accent-primary);
            border-radius: var(--radius-lg);
            padding: 25px;
            margin: 20px 0;
        }

        .theorem-title {
            font-weight: 700;
            font-size: 1.2rem;
            color: var(--accent-primary);
            margin-bottom: 15px;
        }

        /* Exam Tip */
        .exam-tip {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border-left: 4px solid var(--accent-warning);
            padding: 15px 20px;
            border-radius: 0 var(--radius-md) var(--radius-md) 0;
            margin: 15px 0;
        }

        [data-theme="dark"] .exam-tip {
            background: linear-gradient(135deg, #78350f, #92400e);
        }

        .exam-tip-label {
            font-weight: 600;
            color: var(--accent-warning);
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 5px;
            margin-bottom: 5px;
        }

        /* Worked Example */
        .worked-example {
            background: var(--bg-tertiary);
            border-radius: var(--radius-lg);
            padding: 20px;
            margin: 20px 0;
        }

        .example-title {
            font-weight: 600;
            font-size: 1.1rem;
            margin-bottom: 15px;
            color: var(--accent-primary);
        }

        .example-problem {
            background: var(--bg-primary);
            padding: 15px;
            border-radius: var(--radius-md);
            margin-bottom: 15px;
            border: 1px solid var(--border-color);
        }

        /* Animation Controls */
        .animation-container {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: 20px;
            margin: 15px 0;
        }

        .animation-step {
            padding: 15px;
            background: var(--bg-secondary);
            border-radius: var(--radius-md);
            margin-bottom: 10px;
            border-left: 4px solid var(--accent-primary);
            display: none;
        }

        .animation-step.active {
            display: block;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .step-number {
            font-weight: 700;
            color: var(--accent-primary);
            margin-bottom: 5px;
        }

        .step-reasoning {
            font-size: 0.9rem;
            color: var(--text-muted);
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px dashed var(--border-color);
        }

        .animation-controls {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .control-btn {
            padding: 8px 16px;
            border: 1px solid var(--border-color);
            background: var(--bg-secondary);
            color: var(--text-primary);
            border-radius: var(--radius-md);
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s;
        }

        .control-btn:hover {
            background: var(--accent-primary);
            color: white;
            border-color: var(--accent-primary);
        }

        .control-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .progress-bar {
            flex: 1;
            height: 6px;
            background: var(--bg-tertiary);
            border-radius: 3px;
            overflow: hidden;
            min-width: 100px;
        }

        .progress-fill {
            height: 100%;
            background: var(--accent-primary);
            transition: width 0.3s ease;
        }

        .step-counter {
            font-size: 0.85rem;
            color: var(--text-muted);
            min-width: 80px;
            text-align: center;
        }

        /* Practice Problem */
        .practice-problem {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: 20px;
            margin: 15px 0;
        }

        .practice-label {
            font-size: 0.8rem;
            text-transform: uppercase;
            color: var(--accent-success);
            font-weight: 600;
            margin-bottom: 10px;
        }

        .practice-question {
            font-size: 1.1rem;
            margin-bottom: 15px;
        }

        .practice-options {
            display: grid;
            gap: 10px;
        }

        .practice-option {
            padding: 12px 15px;
            background: var(--bg-tertiary);
            border: 2px solid var(--border-color);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all 0.2s;
        }

        .practice-option:hover {
            border-color: var(--accent-primary);
        }

        .practice-option.selected {
            border-color: var(--accent-primary);
            background: rgba(67, 97, 238, 0.1);
        }

        .practice-option.correct {
            border-color: var(--accent-success);
            background: rgba(16, 185, 129, 0.1);
        }

        .practice-option.incorrect {
            border-color: var(--accent-danger);
            background: rgba(239, 68, 68, 0.1);
        }

        .practice-feedback {
            margin-top: 15px;
            padding: 15px;
            border-radius: var(--radius-md);
            display: none;
        }

        .practice-feedback.show {
            display: block;
        }

        .practice-feedback.correct {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid var(--accent-success);
        }

        .practice-feedback.incorrect {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid var(--accent-danger);
        }

        /* Decision Flowchart */
        .decision-flowchart {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: 20px;
            margin: 20px 0;
            overflow-x: auto;
        }

        .flowchart-title {
            font-weight: 600;
            font-size: 1.1rem;
            margin-bottom: 20px;
            color: var(--accent-primary);
            text-align: center;
        }

        .flowchart-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .flowchart-node {
            padding: 12px 20px;
            border-radius: var(--radius-md);
            text-align: center;
            max-width: 300px;
        }

        .flowchart-node.question {
            background: var(--accent-primary);
            color: white;
            font-weight: 500;
        }

        .flowchart-node.answer {
            background: var(--bg-tertiary);
            border: 2px solid var(--border-color);
        }

        .flowchart-node.success {
            background: rgba(16, 185, 129, 0.1);
            border: 2px solid var(--accent-success);
            color: var(--accent-success);
        }

        .flowchart-node.warning {
            background: rgba(245, 158, 11, 0.1);
            border: 2px solid var(--accent-warning);
            color: var(--accent-warning);
        }

        .flowchart-node.danger {
            background: rgba(239, 68, 68, 0.1);
            border: 2px solid var(--accent-danger);
            color: var(--accent-danger);
        }

        .flowchart-arrow {
            font-size: 1.5rem;
            color: var(--text-muted);
        }

        .flowchart-branch {
            display: flex;
            gap: 40px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .flowchart-branch-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .flowchart-branch-label {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .flowchart-branch-label.yes {
            background: var(--accent-success);
            color: white;
        }

        .flowchart-branch-label.no {
            background: var(--accent-danger);
            color: white;
        }

        /* Common Mistakes */
        .mistake-item {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: 20px;
            margin-bottom: 15px;
        }

        .mistake-wrong {
            background: rgba(239, 68, 68, 0.1);
            padding: 12px 15px;
            border-radius: var(--radius-md);
            margin-bottom: 10px;
            text-decoration: line-through;
            color: var(--accent-danger);
        }

        .mistake-correct {
            background: rgba(16, 185, 129, 0.1);
            padding: 12px 15px;
            border-radius: var(--radius-md);
            margin-bottom: 10px;
            border-left: 4px solid var(--accent-success);
        }

        .mistake-reason {
            font-size: 0.9rem;
            color: var(--text-muted);
            padding-top: 10px;
        }

        /* Connections */
        .connection-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: 20px;
            margin-bottom: 15px;
            display: flex;
            gap: 15px;
            align-items: flex-start;
        }

        .connection-icon {
            width: 40px;
            height: 40px;
            background: var(--accent-primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            flex-shrink: 0;
        }

        .connection-content h4 {
            font-size: 1rem;
            margin-bottom: 5px;
        }

        .connection-content p {
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        /* Graph Container */
        .graph-container {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: 15px;
            margin: 15px 0;
        }

        /* Checklist */
        .checklist {
            background: var(--bg-secondary);
            border-radius: var(--radius-lg);
            padding: 20px;
        }

        .checklist-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .checklist-item:last-child {
            border-bottom: none;
        }

        .checklist-checkbox {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        /* Visual Diagram */
        .squeeze-visual {
            text-align: center;
            padding: 20px;
            background: var(--bg-tertiary);
            border-radius: var(--radius-lg);
            margin: 15px 0;
        }

        .squeeze-visual .function-label {
            font-weight: 600;
            margin: 5px 0;
        }

        .squeeze-visual .upper {
            color: var(--accent-danger);
        }

        .squeeze-visual .middle {
            color: var(--accent-primary);
        }

        .squeeze-visual .lower {
            color: var(--accent-success);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8rem;
            }

            .nav-tabs {
                justify-content: center;
            }

            .nav-tab {
                padding: 8px 12px;
                font-size: 0.85rem;
            }

            .flowchart-branch {
                flex-direction: column;
                gap: 20px;
            }
        }

        /* ========== TRANSLATION POPUP ========== */
        .translate-popup {
            position: absolute;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-lg);
            padding: 8px;
            z-index: 10000;
            animation: translateFadeIn 0.2s ease;
            max-width: 350px;
        }

        @keyframes translateFadeIn {
            from { opacity: 0; transform: translateX(-50%) translateY(-5px); }
            to { opacity: 1; transform: translateX(-50%) translateY(0); }
        }

        .translate-btn {
            background: var(--accent-primary);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: var(--radius-sm);
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.2s ease;
        }

        .translate-btn:hover { background: #2563eb; transform: scale(1.02); }
        .translate-btn:disabled { background: var(--text-muted); cursor: not-allowed; transform: none; }

        .translation-result {
            margin-top: 8px;
            padding: 10px 12px;
            background: var(--bg-tertiary);
            border-radius: var(--radius-sm);
            font-size: 14px;
            line-height: 1.6;
            color: var(--text-primary);
            word-wrap: break-word;
        }

        .translation-error {
            color: var(--accent-danger);
            background: rgba(239, 68, 68, 0.1);
        }

        .translate-popup::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            border: 8px solid transparent;
            border-top-color: var(--bg-primary);
        }

        .translate-popup.below::after {
            top: -8px;
            bottom: auto;
            border-top-color: transparent;
            border-bottom-color: var(--bg-primary);
        }

        /* ========== INLINE PRACTICE ========== */
        .inline-practice {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.05), rgba(16, 185, 129, 0.1));
            border: 1px solid rgba(16, 185, 129, 0.2);
            border-radius: var(--radius-lg);
            padding: 20px;
            margin-top: 20px;
        }

        .inline-practice-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--accent-success);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .inline-practice-title::before {
            content: '‚úèÔ∏è';
        }
    </style>
</head>
<body>
    <button class="theme-toggle" onclick="toggleTheme()" title="Toggle dark mode">üåô</button>

    <header class="header">
        <div class="header-content">
            <span class="unit-badge">Unit 1: Limits and Continuity</span>
            <h1>U1.3 Squeeze Theorem</h1>
            <p>Use bounding functions to find limits of functions that resist direct calculation</p>
            <div class="header-meta">
                <span class="meta-item">üìö CB Topic: 1.8</span>
                <span class="meta-item"><span class="freq-badge">üìñ Rarely Tested</span></span>
                <span class="meta-item"><span class="difficulty-badge-header">High Difficulty</span></span>
                <span class="meta-item">‚è±Ô∏è ~30 min</span>
            </div>
        </div>
    </header>

    <div class="container">
        <nav class="nav-tabs">
            <button class="nav-tab active" data-section="keypoints">Key Points</button>
            <button class="nav-tab" data-section="prerequisites">Prerequisites</button>
            <button class="nav-tab" data-section="concepts">Concepts</button>
            <button class="nav-tab" data-section="problemtypes">Problem Types</button>
            <button class="nav-tab" data-section="examtips">Exam Tips</button>
            <button class="nav-tab" data-section="mistakes">Common Mistakes</button>
            <button class="nav-tab" data-section="connections">Connections</button>
        </nav>

        <!-- Key Points Section -->
        <section id="keypoints" class="section active">
            <h2 class="section-title">Key Points</h2>

            <div class="key-point">
                <span class="key-point-number">1</span>
                <div>
                    <strong>The Squeeze Theorem works by trapping.</strong> If \(g(x) \leq f(x) \leq h(x)\) near \(a\), and both \(g(x)\) and \(h(x)\) approach \(L\), then \(f(x)\) must also approach \(L\).
                </div>
            </div>

            <div class="key-point">
                <span class="key-point-number">2</span>
                <div>
                    <strong>Squeeze Theorem is typically used when direct methods fail</strong>‚Äîespecially for oscillating functions like \(x\sin(1/x)\) or functions with bounded oscillation.
                </div>
            </div>

            <div class="key-point">
                <span class="key-point-number">3</span>
                <div>
                    <strong>Key bounded inequalities to remember:</strong> \(-1 \leq \sin(\theta) \leq 1\) and \(-1 \leq \cos(\theta) \leq 1\) for all \(\theta\).
                </div>
            </div>

            <div class="key-point">
                <span class="key-point-number">4</span>
                <div>
                    <strong>The bounding functions must have the same limit.</strong> If \(\lim g(x) \neq \lim h(x)\), the Squeeze Theorem cannot be applied.
                </div>
            </div>

            <div class="key-point">
                <span class="key-point-number">5</span>
                <div>
                    <strong>The classic application:</strong> \(\displaystyle\lim_{x \to 0} x \sin\left(\frac{1}{x}\right) = 0\) because \(-|x| \leq x\sin(1/x) \leq |x|\) and both bounds approach 0.
                </div>
            </div>
        </section>

        <!-- Prerequisites Section -->
        <section id="prerequisites" class="section">
            <h2 class="section-title">Prerequisites</h2>

            <div class="prereq-card">
                <div class="prereq-header" onclick="togglePrereq(this)">
                    <span class="prereq-title">
                        <span class="prereq-badge">PreCalc</span>
                        Range and Bounds of Functions
                    </span>
                    <span class="prereq-toggle">‚ñº</span>
                </div>
                <div class="prereq-content">
                    <p><strong>Why it matters:</strong> The Squeeze Theorem requires knowing the range of functions to set up the bounding inequalities.</p>

                    <div class="pattern-box">
                        <div class="pattern-label">Bounded Functions</div>
                        <p>A function \(f(x)\) is <strong>bounded</strong> if there exist numbers \(m\) and \(M\) such that \(m \leq f(x) \leq M\) for all \(x\) in the domain.</p>
                    </div>

                    <div class="pattern-box">
                        <div class="pattern-label">Key Bounded Functions</div>
                        <ul style="margin-top: 10px; margin-left: 20px;">
                            <li>\(-1 \leq \sin(\theta) \leq 1\) for all \(\theta\)</li>
                            <li>\(-1 \leq \cos(\theta) \leq 1\) for all \(\theta\)</li>
                            <li>\(0 \leq |\sin(\theta)| \leq 1\)</li>
                            <li>\(0 \leq \sin^2(\theta) \leq 1\)</li>
                        </ul>
                    </div>

                    <div class="practice-problem">
                        <div class="practice-label">Quick Check</div>
                        <div class="practice-question">What are the bounds for \(\cos(1/x)\)?</div>
                        <div class="practice-options">
                            <div class="practice-option" data-correct="true">\(-1 \leq \cos(1/x) \leq 1\)</div>
                            <div class="practice-option">\(0 \leq \cos(1/x) \leq 1\)</div>
                            <div class="practice-option">\(-1/x \leq \cos(1/x) \leq 1/x\)</div>
                            <div class="practice-option">Cannot be determined</div>
                        </div>
                        <div class="practice-feedback"></div>
                    </div>
                </div>
            </div>

            <div class="prereq-card">
                <div class="prereq-header" onclick="togglePrereq(this)">
                    <span class="prereq-title">
                        <span class="prereq-badge internal">Internal</span>
                        U1.2 Calculating Limits
                    </span>
                    <span class="prereq-toggle">‚ñº</span>
                </div>
                <div class="prereq-content">
                    <p>Before using the Squeeze Theorem, you should be comfortable with:</p>
                    <ul style="margin: 10px 0 10px 20px;">
                        <li>Direct substitution for limits</li>
                        <li>Recognizing when standard methods don't work</li>
                        <li>The special trig limits \(\frac{\sin x}{x} \to 1\)</li>
                    </ul>
                    <p><a href="U1.2-Calculating-Limit.html" style="color: var(--accent-primary);">‚Üí Review U1.2 Calculating Limits</a></p>
                </div>
            </div>
        </section>

        <!-- Concepts Section -->
        <section id="concepts" class="section">
            <h2 class="section-title">Core Concepts</h2>

            <div class="theorem-box">
                <div class="theorem-title">üìê The Squeeze Theorem (Sandwich Theorem)</div>
                <p>If \(g(x) \leq f(x) \leq h(x)\) for all \(x\) near \(a\) (except possibly at \(a\)), and</p>
                <p style="text-align: center; font-size: 1.2rem; margin: 15px 0;">
                    \(\displaystyle\lim_{x \to a} g(x) = \lim_{x \to a} h(x) = L\)
                </p>
                <p>then</p>
                <p style="text-align: center; font-size: 1.2rem; margin: 15px 0;">
                    \(\displaystyle\lim_{x \to a} f(x) = L\)
                </p>
            </div>

            <div class="squeeze-visual">
                <div class="function-label upper">h(x) - Upper bound ‚Üí L</div>
                <div style="font-size: 2rem;">‚¨áÔ∏è</div>
                <div class="function-label middle">f(x) - Squeezed function ‚Üí L</div>
                <div style="font-size: 2rem;">‚¨ÜÔ∏è</div>
                <div class="function-label lower">g(x) - Lower bound ‚Üí L</div>
            </div>

            <div class="card">
                <h3 class="card-title">Visual Intuition</h3>
                <p>Imagine \(f(x)\) is squeezed between two functions. As we approach the limit point, the upper and lower bounds both converge to the same value, forcing \(f(x)\) to that value too.</p>

                <div class="graph-container" id="squeeze-theorem-graph"></div>
            </div>

            <div class="decision-flowchart">
                <div class="flowchart-title">Decision Flowchart: When to Use Squeeze Theorem</div>
                <div class="flowchart-container">
                    <div class="flowchart-node question">Can you evaluate the limit directly?</div>
                    <div class="flowchart-arrow">‚Üì</div>
                    <div class="flowchart-branch">
                        <div class="flowchart-branch-item">
                            <div class="flowchart-branch-label yes">YES</div>
                            <div class="flowchart-node success">Use direct methods</div>
                        </div>
                        <div class="flowchart-branch-item">
                            <div class="flowchart-branch-label no">NO</div>
                            <div class="flowchart-node answer">‚Üì Continue</div>
                        </div>
                    </div>
                    <div class="flowchart-arrow">‚Üì</div>
                    <div class="flowchart-node question">Does the function involve bounded oscillation?<br>(sin, cos of complicated argument)</div>
                    <div class="flowchart-arrow">‚Üì</div>
                    <div class="flowchart-branch">
                        <div class="flowchart-branch-item">
                            <div class="flowchart-branch-label yes">YES</div>
                            <div class="flowchart-node success">Use Squeeze Theorem!</div>
                        </div>
                        <div class="flowchart-branch-item">
                            <div class="flowchart-branch-label no">NO</div>
                            <div class="flowchart-node warning">Try other methods</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3 class="card-title">The Setup Process</h3>
                <p>To apply the Squeeze Theorem:</p>

                <ol style="margin: 15px 0 0 20px;">
                    <li><strong>Identify the bounded part</strong> - Usually \(\sin(\cdot)\) or \(\cos(\cdot)\)</li>
                    <li><strong>Write the inequality</strong> - Use \(-1 \leq \sin(\cdot) \leq 1\)</li>
                    <li><strong>Multiply through</strong> - Multiply all parts by the other factor</li>
                    <li><strong>Find limits of bounds</strong> - Evaluate \(\lim g(x)\) and \(\lim h(x)\)</li>
                    <li><strong>Apply the theorem</strong> - If both bounds equal \(L\), so does \(f(x)\)</li>
                </ol>
            </div>
        </section>

        <!-- Problem Types Section -->
        <section id="problemtypes" class="section">
            <h2 class="section-title">Problem Types</h2>

            <!-- Type 1: Bounded Oscillating Functions -->
            <div class="problem-type collapsed" id="problem-type-1">
                <div class="problem-type-header">
                    <span class="problem-type-title">Type 1: Bounded Oscillating Functions</span>
                    <span class="difficulty-badge medium">Intermediate</span>
                    <span class="toggle-icon">‚ñº</span>
                </div>
                <div class="problem-type-content">
                    <div class="pattern-box">
                        <div class="pattern-label">Recognition Pattern</div>
                        <p>Functions like \(x\sin(1/x)\), \(x^2\cos(1/x)\), etc.</p>
                        <p style="margin-top: 10px;"><strong>Key insight:</strong> The oscillating part is bounded, but we can't substitute due to the \(1/x\).</p>
                    </div>

                    <div class="exam-tip">
                        <div class="exam-tip-label">üí° EXAM TIP</div>
                        When you see \(x^n \cdot \sin(1/x)\) or \(x^n \cdot \cos(1/x)\) as \(x \to 0\), the limit is 0 if \(n > 0\).
                    </div>

                    <div class="worked-example">
                        <div class="example-title">Worked Example</div>
                        <div class="example-problem">
                            Evaluate: \(\displaystyle\lim_{x \to 0} x\sin\left(\frac{1}{x}\right)\)
                        </div>

                        <div class="animation-container" id="anim-squeeze-basic">
                            <div class="animation-step" data-step="1">
                                <div class="step-number">Step 1: Try direct substitution</div>
                                <p>As \(x \to 0\), \(\sin(1/x)\) oscillates wildly between -1 and 1.</p>
                                <p>Direct substitution gives: \(0 \cdot (\text{undefined oscillation})\)</p>
                                <div class="step-reasoning">üí≠ We can't evaluate directly‚Äîneed Squeeze Theorem!</div>
                            </div>
                            <div class="animation-step" data-step="2">
                                <div class="step-number">Step 2: Identify the bounded part</div>
                                <p>\(-1 \leq \sin\left(\frac{1}{x}\right) \leq 1\) for all \(x \neq 0\)</p>
                                <div class="step-reasoning">üí≠ Sine is always between -1 and 1, no matter what its argument is.</div>
                            </div>
                            <div class="animation-step" data-step="3">
                                <div class="step-number">Step 3: Multiply through by x (case x > 0)</div>
                                <p>For \(x > 0\): \(-x \leq x\sin\left(\frac{1}{x}\right) \leq x\)</p>
                                <div class="step-reasoning">üí≠ Multiplying inequalities by a positive number preserves direction.</div>
                            </div>
                            <div class="animation-step" data-step="4">
                                <div class="step-number">Step 4: Evaluate the bounds</div>
                                <p>\(\displaystyle\lim_{x \to 0^+} (-x) = 0\) and \(\displaystyle\lim_{x \to 0^+} x = 0\)</p>
                                <div class="step-reasoning">üí≠ Both bounding functions approach 0.</div>
                            </div>
                            <div class="animation-step" data-step="5">
                                <div class="step-number">Step 5: Apply Squeeze Theorem</div>
                                <p>Since \(-x \leq x\sin(1/x) \leq x\) and both bounds ‚Üí 0:</p>
                                <p style="font-size: 1.2rem; text-align: center; margin-top: 10px;">\(\displaystyle\lim_{x \to 0} x\sin\left(\frac{1}{x}\right) = 0\)</p>
                                <div class="step-reasoning">üí≠ The function is "squeezed" to 0. (Same argument works for x < 0 using |x|.)</div>
                            </div>
                            <div class="animation-controls">
                                <button class="control-btn" onclick="animPrev('anim-squeeze-basic')">‚Üê Prev</button>
                                <button class="control-btn" onclick="animNext('anim-squeeze-basic')">Next ‚Üí</button>
                                <div class="progress-bar"><div class="progress-fill" style="width: 20%"></div></div>
                                <span class="step-counter">Step 1 of 5</span>
                                <button class="control-btn" onclick="animReset('anim-squeeze-basic')">Reset</button>
                            </div>
                        </div>
                    </div>

                    <div class="practice-problem">
                        <div class="practice-label">Practice Problem</div>
                        <div class="practice-question">Evaluate: \(\displaystyle\lim_{x \to 0} x^2\cos\left(\frac{1}{x}\right)\)</div>
                        <div class="practice-options">
                            <div class="practice-option" data-correct="true">0</div>
                            <div class="practice-option">1</div>
                            <div class="practice-option">Does not exist</div>
                            <div class="practice-option">-1</div>
                        </div>
                        <div class="practice-feedback"></div>
                    </div>
                </div>
            </div>

            <!-- Type 2: Proving Standard Limits -->
            <div class="problem-type collapsed" id="problem-type-2">
                <div class="problem-type-header">
                    <span class="problem-type-title">Type 2: Proving Standard Limits</span>
                    <span class="difficulty-badge hard">Advanced</span>
                    <span class="toggle-icon">‚ñº</span>
                </div>
                <div class="problem-type-content">
                    <div class="pattern-box">
                        <div class="pattern-label">Recognition Pattern</div>
                        <p>Proving limits like \(\lim_{x \to 0} \frac{\sin x}{x} = 1\) using geometric inequalities.</p>
                    </div>

                    <div class="card">
                        <h4>The Geometric Squeeze for \(\frac{\sin x}{x}\)</h4>
                        <p>Using the unit circle, we can show:</p>
                        <p style="text-align: center; margin: 15px 0; font-size: 1.1rem;">
                            \(\cos x \leq \frac{\sin x}{x} \leq 1\) for \(0 < x < \frac{\pi}{2}\)
                        </p>
                        <p>Since \(\lim_{x \to 0} \cos x = 1\) and \(\lim_{x \to 0} 1 = 1\), by the Squeeze Theorem:</p>
                        <p style="text-align: center; font-size: 1.2rem; color: var(--accent-primary);">
                            \(\displaystyle\lim_{x \to 0} \frac{\sin x}{x} = 1\)
                        </p>
                    </div>

                    <div class="graph-container" id="sinx-over-x-bounds-graph"></div>

                    <div class="inline-practice">
                        <h4 class="inline-practice-title">Practice This Type</h4>
                        <div class="practice-problem">
                            <div class="practice-label">Practice Problem</div>
                            <div class="practice-question">Using the Squeeze Theorem and the fact that \(-1 \leq \cos x \leq 1\), what is \(\displaystyle\lim_{x \to 0} x^2 \cos\left(\frac{1}{x}\right)\)?</div>
                            <div class="practice-options">
                                <div class="practice-option" data-correct="true">0</div>
                                <div class="practice-option">1</div>
                                <div class="practice-option">Does not exist</div>
                                <div class="practice-option">-1</div>
                            </div>
                            <div class="practice-feedback"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Type 3: Comparison with Known Bounds -->
            <div class="problem-type collapsed" id="problem-type-3">
                <div class="problem-type-header">
                    <span class="problem-type-title">Type 3: Comparison with Known Bounds</span>
                    <span class="difficulty-badge medium">Intermediate</span>
                    <span class="toggle-icon">‚ñº</span>
                </div>
                <div class="problem-type-content">
                    <div class="pattern-box">
                        <div class="pattern-label">Recognition Pattern</div>
                        <p>Given inequalities like \(f(x) \leq g(x) \leq h(x)\), find \(\lim g(x)\).</p>
                    </div>

                    <div class="worked-example">
                        <div class="example-title">Worked Example</div>
                        <div class="example-problem">
                            Given that \(3x + 1 \leq f(x) \leq x^2 + 3x + 1\) for all \(x\), find \(\displaystyle\lim_{x \to 0} f(x)\).
                        </div>

                        <div class="animation-container" id="anim-comparison">
                            <div class="animation-step" data-step="1">
                                <div class="step-number">Step 1: Identify the bounds</div>
                                <p>Lower bound: \(g(x) = 3x + 1\)</p>
                                <p>Upper bound: \(h(x) = x^2 + 3x + 1\)</p>
                                <div class="step-reasoning">üí≠ We're given the bounding functions directly.</div>
                            </div>
                            <div class="animation-step" data-step="2">
                                <div class="step-number">Step 2: Evaluate lower bound</div>
                                <p>\(\displaystyle\lim_{x \to 0} (3x + 1) = 3(0) + 1 = 1\)</p>
                                <div class="step-reasoning">üí≠ Direct substitution works for the lower bound.</div>
                            </div>
                            <div class="animation-step" data-step="3">
                                <div class="step-number">Step 3: Evaluate upper bound</div>
                                <p>\(\displaystyle\lim_{x \to 0} (x^2 + 3x + 1) = 0 + 0 + 1 = 1\)</p>
                                <div class="step-reasoning">üí≠ Direct substitution works for the upper bound too.</div>
                            </div>
                            <div class="animation-step" data-step="4">
                                <div class="step-number">Step 4: Apply Squeeze Theorem</div>
                                <p>Since both bounds equal 1:</p>
                                <p style="font-size: 1.2rem; text-align: center;">\(\displaystyle\lim_{x \to 0} f(x) = 1\)</p>
                                <div class="step-reasoning">üí≠ The function f(x) is squeezed to the same limit.</div>
                            </div>
                            <div class="animation-controls">
                                <button class="control-btn" onclick="animPrev('anim-comparison')">‚Üê Prev</button>
                                <button class="control-btn" onclick="animNext('anim-comparison')">Next ‚Üí</button>
                                <div class="progress-bar"><div class="progress-fill" style="width: 25%"></div></div>
                                <span class="step-counter">Step 1 of 4</span>
                                <button class="control-btn" onclick="animReset('anim-comparison')">Reset</button>
                            </div>
                        </div>
                    </div>

                    <div class="practice-problem">
                        <div class="practice-label">Practice Problem</div>
                        <div class="practice-question">If \(2 - x^2 \leq f(x) \leq 2 + x^2\) for all \(x\), find \(\displaystyle\lim_{x \to 0} f(x)\).</div>
                        <div class="practice-options">
                            <div class="practice-option">0</div>
                            <div class="practice-option" data-correct="true">2</div>
                            <div class="practice-option">4</div>
                            <div class="practice-option">Does not exist</div>
                        </div>
                        <div class="practice-feedback"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Exam Tips Section -->
        <section id="examtips" class="section">
            <h2 class="section-title">Exam Tips</h2>

            <div class="decision-flowchart">
                <div class="flowchart-title">Master Decision Tree: Squeeze Theorem Problems</div>
                <div class="flowchart-container">
                    <div class="flowchart-node question">Is there an oscillating function (sin, cos)?</div>
                    <div class="flowchart-arrow">‚Üì</div>
                    <div class="flowchart-branch">
                        <div class="flowchart-branch-item">
                            <div class="flowchart-branch-label yes">YES</div>
                            <div class="flowchart-node answer">Is it multiplied by x^n?</div>
                        </div>
                        <div class="flowchart-branch-item">
                            <div class="flowchart-branch-label no">NO</div>
                            <div class="flowchart-node warning">Try algebraic methods first</div>
                        </div>
                    </div>
                    <div class="flowchart-arrow">‚Üì</div>
                    <div class="flowchart-branch">
                        <div class="flowchart-branch-item">
                            <div class="flowchart-branch-label yes">YES (n > 0)</div>
                            <div class="flowchart-node success">Limit = 0 as x‚Üí0</div>
                        </div>
                        <div class="flowchart-branch-item">
                            <div class="flowchart-branch-label no">NO</div>
                            <div class="flowchart-node danger">May need more analysis</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3 class="card-title">Quick Reference</h3>
                <div class="pattern-box">
                    <div class="pattern-label">Instant Recognition Patterns</div>
                    <ul style="margin-top: 10px;">
                        <li>\(\lim_{x \to 0} x \cdot \sin(1/x) = 0\) ‚úì</li>
                        <li>\(\lim_{x \to 0} x^2 \cdot \cos(1/x) = 0\) ‚úì</li>
                        <li>\(\lim_{x \to 0} x \cdot \cos(1/x^2) = 0\) ‚úì</li>
                        <li>\(\lim_{x \to 0} \sqrt{x} \cdot \sin(1/x) = 0\) ‚úì (for x > 0)</li>
                    </ul>
                </div>

                <div class="exam-tip">
                    <div class="exam-tip-label">üí° TIP #1: The Magic Pattern</div>
                    Any function of the form \([\text{goes to } 0] \times [\text{bounded}]\) has limit 0.
                </div>

                <div class="exam-tip">
                    <div class="exam-tip-label">üí° TIP #2: Use Absolute Value</div>
                    Instead of handling positive and negative x separately, use: \(|x \sin(1/x)| \leq |x| \to 0\)
                </div>

                <div class="exam-tip">
                    <div class="exam-tip-label">üí° TIP #3: Check Both Bounds</div>
                    Always verify BOTH bounding limits are equal before applying the theorem.
                </div>
            </div>
        </section>

        <!-- Common Mistakes Section -->
        <section id="mistakes" class="section">
            <h2 class="section-title">Common Mistakes</h2>

            <div class="decision-flowchart">
                <div class="flowchart-title">Verification Checklist</div>
                <div class="flowchart-container">
                    <div class="flowchart-node question">Did you verify the inequality holds near a?</div>
                    <div class="flowchart-arrow">‚Üì</div>
                    <div class="flowchart-branch">
                        <div class="flowchart-branch-item">
                            <div class="flowchart-branch-label yes">YES</div>
                            <div class="flowchart-node answer">Continue ‚Üì</div>
                        </div>
                        <div class="flowchart-branch-item">
                            <div class="flowchart-branch-label no">NO</div>
                            <div class="flowchart-node danger">Go back and check!</div>
                        </div>
                    </div>
                    <div class="flowchart-arrow">‚Üì</div>
                    <div class="flowchart-node question">Do BOTH bounds have the same limit?</div>
                    <div class="flowchart-arrow">‚Üì</div>
                    <div class="flowchart-branch">
                        <div class="flowchart-branch-item">
                            <div class="flowchart-branch-label yes">YES</div>
                            <div class="flowchart-node success">Theorem applies ‚úì</div>
                        </div>
                        <div class="flowchart-branch-item">
                            <div class="flowchart-branch-label no">NO</div>
                            <div class="flowchart-node danger">Cannot use Squeeze Theorem!</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mistake-item">
                <h4>Mistake #1: Bounds have different limits</h4>
                <div class="mistake-wrong">\(-x \leq f(x) \leq x^2\) as \(x \to 0\), so limit is... both 0? ‚úó</div>
                <div class="mistake-correct">
                    <strong>Check:</strong> \(\lim (-x) = 0\) and \(\lim (x^2) = 0\). Both ARE equal here!<br>
                    But if bounds were \(1\) and \(x\), we'd have \(\lim = 1\) and \(\lim = 0\) ‚Äî Squeeze Theorem wouldn't apply.
                </div>
                <div class="mistake-reason">
                    <strong>Why this happens:</strong> Students forget to verify that both bounds converge to the SAME value.
                </div>
            </div>

            <div class="mistake-item">
                <h4>Mistake #2: Forgetting the sign of x when multiplying</h4>
                <div class="mistake-wrong">Since \(-1 \leq \sin(1/x) \leq 1\), multiply by x to get \(-x \leq x\sin(1/x) \leq x\) ‚úó</div>
                <div class="mistake-correct">
                    <strong>Correct:</strong> This only works for \(x > 0\). For \(x < 0\), the inequalities flip!<br>
                    Safer approach: Use \(|x\sin(1/x)| \leq |x|\), which works for all x.
                </div>
                <div class="mistake-reason">
                    <strong>Why this happens:</strong> Multiplying an inequality by a negative number reverses the direction.
                </div>
            </div>

            <div class="mistake-item">
                <h4>Mistake #3: Applying Squeeze Theorem when not needed</h4>
                <div class="mistake-wrong">\(\lim_{x \to 0} x^2 + x\)... let me use Squeeze Theorem... ‚úó</div>
                <div class="mistake-correct">
                    <strong>Correct:</strong> Direct substitution gives \(0^2 + 0 = 0\). Done!<br>
                    Squeeze Theorem is for when direct methods fail.
                </div>
                <div class="mistake-reason">
                    <strong>Why this happens:</strong> Overcomplicating. Always try simple methods first.
                </div>
            </div>
        </section>

        <!-- Connections Section -->
        <section id="connections" class="section">
            <h2 class="section-title">Forward Connections</h2>

            <div class="connection-card">
                <div class="connection-icon">üìä</div>
                <div class="connection-content">
                    <h4>U1.4 Continuity</h4>
                    <p>Squeeze Theorem can help prove continuity at difficult points where direct evaluation is impossible.</p>
                </div>
            </div>

            <div class="connection-card">
                <div class="connection-icon">üìà</div>
                <div class="connection-content">
                    <h4>U2.2 Definition of Derivative</h4>
                    <p>Some derivative proofs (especially for piecewise functions at boundary points) use the Squeeze Theorem.</p>
                </div>
            </div>

            <div class="connection-card">
                <div class="connection-icon">üî¢</div>
                <div class="connection-content">
                    <h4>U10.2 Series Convergence Tests</h4>
                    <p>The Comparison Test for series is conceptually similar to the Squeeze Theorem‚Äîbounding an unknown series by known convergent/divergent series.</p>
                </div>
            </div>

            <div class="card">
                <h3 class="card-title">Self-Assessment Checklist</h3>
                <div class="checklist">
                    <div class="checklist-item">
                        <input type="checkbox" class="checklist-checkbox" id="check1">
                        <label for="check1">I can state the Squeeze Theorem</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" class="checklist-checkbox" id="check2">
                        <label for="check2">I know when to use Squeeze Theorem (oscillating functions)</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" class="checklist-checkbox" id="check3">
                        <label for="check3">I can set up bounding inequalities using \(-1 \leq \sin \leq 1\)</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" class="checklist-checkbox" id="check4">
                        <label for="check4">I remember to check that both bounds have the same limit</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" class="checklist-checkbox" id="check5">
                        <label for="check5">I can handle the \(x \sin(1/x)\) type problems quickly</label>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <script>
        // Theme Toggle
        function toggleTheme() {
            const body = document.body;
            const currentTheme = body.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            body.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            document.querySelector('.theme-toggle').textContent = newTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';

            renderGraphs();
        }

        // Load saved theme
        const savedTheme = localStorage.getItem('theme') || 'light';
        document.body.setAttribute('data-theme', savedTheme);
        document.querySelector('.theme-toggle').textContent = savedTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';

        // Navigation
        document.querySelectorAll('.nav-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));

                tab.classList.add('active');
                const sectionId = tab.getAttribute('data-section');
                document.getElementById(sectionId).classList.add('active');
            });
        });

        // Prerequisites Toggle
        function togglePrereq(header) {
            const card = header.parentElement;
            const content = card.querySelector('.prereq-content');

            card.classList.toggle('open');
            content.classList.toggle('active');
        }

        // Problem Type Accordion
        document.querySelectorAll('.problem-type .problem-type-header').forEach(header => {
            header.addEventListener('click', () => {
                const parent = header.parentElement;
                const wasCollapsed = parent.classList.contains('collapsed');

                document.querySelectorAll('.problem-type[id^="problem-type-"]').forEach(pt => {
                    pt.classList.add('collapsed');
                });

                if (wasCollapsed) {
                    parent.classList.remove('collapsed');
                }
            });
        });

        // Animation System
        const animations = {};

        function initAnimation(containerId) {
            const container = document.getElementById(containerId);
            if (!container) return;

            const steps = container.querySelectorAll('.animation-step');
            animations[containerId] = {
                currentStep: 1,
                totalSteps: steps.length
            };

            updateAnimation(containerId);
        }

        function updateAnimation(containerId) {
            const container = document.getElementById(containerId);
            const anim = animations[containerId];

            container.querySelectorAll('.animation-step').forEach((step, index) => {
                step.classList.toggle('active', index + 1 === anim.currentStep);
            });

            const progressFill = container.querySelector('.progress-fill');
            const stepCounter = container.querySelector('.step-counter');

            progressFill.style.width = `${(anim.currentStep / anim.totalSteps) * 100}%`;
            stepCounter.textContent = `Step ${anim.currentStep} of ${anim.totalSteps}`;
        }

        function animNext(containerId) {
            const anim = animations[containerId];
            if (anim.currentStep < anim.totalSteps) {
                anim.currentStep++;
                updateAnimation(containerId);
            }
        }

        function animPrev(containerId) {
            const anim = animations[containerId];
            if (anim.currentStep > 1) {
                anim.currentStep--;
                updateAnimation(containerId);
            }
        }

        function animReset(containerId) {
            animations[containerId].currentStep = 1;
            updateAnimation(containerId);
        }

        // Practice Problem Handler
        document.querySelectorAll('.practice-option').forEach(option => {
            option.addEventListener('click', function() {
                const problem = this.closest('.practice-problem');
                const options = problem.querySelectorAll('.practice-option');
                const feedback = problem.querySelector('.practice-feedback');

                options.forEach(opt => {
                    opt.classList.remove('selected', 'correct', 'incorrect');
                });

                this.classList.add('selected');

                const isCorrect = this.getAttribute('data-correct') === 'true';

                if (isCorrect) {
                    this.classList.add('correct');
                    feedback.textContent = '‚úì Correct! Great work.';
                    feedback.className = 'practice-feedback show correct';
                } else {
                    this.classList.add('incorrect');
                    const correctOption = problem.querySelector('[data-correct="true"]');
                    correctOption.classList.add('correct');
                    feedback.textContent = '‚úó Not quite. The correct answer is highlighted.';
                    feedback.className = 'practice-feedback show incorrect';
                }
            });
        });

        // Render Graphs
        function renderGraphs() {
            const isDark = document.body.getAttribute('data-theme') === 'dark';
            const bgColor = isDark ? '#1a1a2e' : '#ffffff';
            const textColor = isDark ? '#eef0f2' : '#212529';
            const gridColor = isDark ? '#2d3748' : '#e9ecef';

            // Squeeze Theorem visualization
            const squeezeDiv = document.getElementById('squeeze-theorem-graph');
            if (squeezeDiv) {
                const x = [];
                const yMiddle = [];
                const yUpper = [];
                const yLower = [];

                for (let i = -2; i <= 2; i += 0.01) {
                    if (Math.abs(i) > 0.01) {
                        x.push(i);
                        yMiddle.push(i * Math.sin(1/i));
                        yUpper.push(Math.abs(i));
                        yLower.push(-Math.abs(i));
                    }
                }

                Plotly.newPlot('squeeze-theorem-graph', [
                    {
                        x: x,
                        y: yUpper,
                        type: 'scatter',
                        mode: 'lines',
                        line: { color: '#ef4444', width: 2, dash: 'dash' },
                        name: 'h(x) = |x|'
                    },
                    {
                        x: x,
                        y: yLower,
                        type: 'scatter',
                        mode: 'lines',
                        line: { color: '#10b981', width: 2, dash: 'dash' },
                        name: 'g(x) = -|x|'
                    },
                    {
                        x: x,
                        y: yMiddle,
                        type: 'scatter',
                        mode: 'lines',
                        line: { color: '#4361ee', width: 2 },
                        name: 'f(x) = x¬∑sin(1/x)'
                    }
                ], {
                    title: {
                        text: 'Squeeze Theorem: x¬∑sin(1/x) squeezed by ¬±|x|',
                        font: { color: textColor }
                    },
                    xaxis: {
                        title: 'x',
                        gridcolor: gridColor,
                        zerolinecolor: textColor,
                        tickfont: { color: textColor },
                        range: [-1, 1]
                    },
                    yaxis: {
                        title: 'y',
                        gridcolor: gridColor,
                        zerolinecolor: textColor,
                        tickfont: { color: textColor },
                        range: [-1, 1]
                    },
                    paper_bgcolor: bgColor,
                    plot_bgcolor: bgColor,
                    font: { color: textColor },
                    legend: {
                        x: 0.02,
                        y: 0.98,
                        font: { color: textColor }
                    }
                }, {
                    responsive: true
                });
            }

            // sin(x)/x bounds graph
            const sinBoundsDiv = document.getElementById('sinx-over-x-bounds-graph');
            if (sinBoundsDiv) {
                const x = [];
                const ySinX = [];
                const yCosX = [];
                const yOne = [];

                for (let i = 0.01; i <= 1.5; i += 0.01) {
                    x.push(i);
                    ySinX.push(Math.sin(i) / i);
                    yCosX.push(Math.cos(i));
                    yOne.push(1);
                }

                Plotly.newPlot('sinx-over-x-bounds-graph', [
                    {
                        x: x,
                        y: yOne,
                        type: 'scatter',
                        mode: 'lines',
                        line: { color: '#ef4444', width: 2, dash: 'dash' },
                        name: 'Upper bound: 1'
                    },
                    {
                        x: x,
                        y: yCosX,
                        type: 'scatter',
                        mode: 'lines',
                        line: { color: '#10b981', width: 2, dash: 'dash' },
                        name: 'Lower bound: cos(x)'
                    },
                    {
                        x: x,
                        y: ySinX,
                        type: 'scatter',
                        mode: 'lines',
                        line: { color: '#4361ee', width: 2 },
                        name: 'sin(x)/x'
                    }
                ], {
                    title: {
                        text: 'cos(x) ‚â§ sin(x)/x ‚â§ 1',
                        font: { color: textColor }
                    },
                    xaxis: {
                        title: 'x',
                        gridcolor: gridColor,
                        zerolinecolor: textColor,
                        tickfont: { color: textColor }
                    },
                    yaxis: {
                        title: 'y',
                        gridcolor: gridColor,
                        zerolinecolor: textColor,
                        tickfont: { color: textColor },
                        range: [0.5, 1.1]
                    },
                    paper_bgcolor: bgColor,
                    plot_bgcolor: bgColor,
                    font: { color: textColor },
                    legend: {
                        x: 0.6,
                        y: 0.3,
                        font: { color: textColor }
                    },
                    annotations: [{
                        x: 0,
                        y: 1,
                        text: 'All converge to 1',
                        showarrow: true,
                        arrowhead: 2,
                        ax: 60,
                        ay: 20,
                        font: { color: textColor }
                    }]
                }, {
                    responsive: true
                });
            }
        }

        // KaTeX rendering
        document.addEventListener('DOMContentLoaded', function() {
            renderMathInElement(document.body, {
                delimiters: [
                    {left: '\\[', right: '\\]', display: true},
                    {left: '\\(', right: '\\)', display: false},
                    {left: '$', right: '$', display: false}
                ],
                throwOnError: false
            });

            initAnimation('anim-squeeze-basic');
            initAnimation('anim-comparison');

            renderGraphs();
        });

        // ============================================
        // TRANSLATION FEATURE
        // ============================================
        const TRANSLATION_CONFIG = {
            endpoint: '/api/translate',
            maxLength: 2000
        };

        async function translateToChinese(text) {
            if (text.length > TRANSLATION_CONFIG.maxLength) {
                text = text.substring(0, TRANSLATION_CONFIG.maxLength);
            }

            const response = await fetch(TRANSLATION_CONFIG.endpoint, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ text, source: 'auto', target: 'zh' })
            });

            if (!response.ok) {
                throw new Error(`Translation failed: ${response.status}`);
            }

            const data = await response.json();
            return data.translation;
        }

        let translatePopup = null;

        function clearTranslatePopup() {
            if (translatePopup) {
                translatePopup.remove();
                translatePopup = null;
            }
        }

        function createTranslatePopup(selectedText, rect) {
            clearTranslatePopup();

            const popup = document.createElement('div');
            popup.className = 'translate-popup';
            popup.id = 'translate-popup';

            const scrollTop = window.scrollY;
            const scrollLeft = window.scrollX;
            const spaceAbove = rect.top;
            const showBelow = spaceAbove < 70;

            let top = showBelow
                ? rect.bottom + scrollTop + 12
                : rect.top + scrollTop - 60;
            let left = rect.left + scrollLeft + (rect.width / 2);

            const viewportWidth = window.innerWidth;
            left = Math.max(100, Math.min(left, viewportWidth - 100));

            if (showBelow) popup.classList.add('below');

            popup.style.cssText = `
                position: absolute;
                top: ${top}px;
                left: ${left}px;
                transform: translateX(-50%);
            `;

            popup.innerHTML = `
                <button class="translate-btn" id="do-translate">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M5 8l6 6M4 14h6v6M15 4h5v5M14.5 4l5 5"/>
                        <path d="M2 5h12M9 2v6"/>
                    </svg>
                    ÁøªËØëÊàê‰∏≠Êñá
                </button>
            `;

            document.body.appendChild(popup);
            translatePopup = popup;

            popup.querySelector('#do-translate').addEventListener('click', async () => {
                const btn = popup.querySelector('#do-translate');
                btn.disabled = true;
                btn.textContent = 'ÁøªËØë‰∏≠...';

                try {
                    const translation = await translateToChinese(selectedText);
                    btn.style.display = 'none';

                    const resultDiv = document.createElement('div');
                    resultDiv.className = 'translation-result';
                    resultDiv.textContent = translation;
                    popup.appendChild(resultDiv);

                    if (!showBelow) {
                        const newHeight = popup.offsetHeight;
                        popup.style.top = `${rect.top + scrollTop - newHeight - 12}px`;
                    }
                } catch (error) {
                    const errorDiv = document.createElement('div');
                    errorDiv.className = 'translation-result translation-error';
                    errorDiv.textContent = 'ÁøªËØëÂ§±Ë¥•ÔºåËØ∑ÈáçËØï';
                    popup.appendChild(errorDiv);
                    btn.style.display = 'none';
                }
            });
        }

        function handleTextSelection() {
            setTimeout(() => {
                const selection = window.getSelection();
                const selectedText = selection.toString().trim();

                if (selectedText.length > 0 && selectedText.length < 5000) {
                    const range = selection.getRangeAt(0);
                    const rect = range.getBoundingClientRect();
                    createTranslatePopup(selectedText, rect);
                }
            }, 10);
        }

        (function initTranslation() {
            const isTouchDevice = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
            if (isTouchDevice) return;

            document.addEventListener('mouseup', (e) => {
                if (e.target.closest('#translate-popup')) return;
                handleTextSelection();
            });

            document.addEventListener('mousedown', (e) => {
                if (!e.target.closest('#translate-popup')) {
                    clearTranslatePopup();
                }
            });

            document.addEventListener('selectstart', clearTranslatePopup);
            document.addEventListener('scroll', clearTranslatePopup);
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    clearTranslatePopup();
                    window.getSelection().removeAllRanges();
                }
            });
        })();
    </script>

    <!-- Tencent CloudBase JS SDK -->
    <script src="https://static.cloudbase.net/cloudbase-js-sdk/latest/cloudbase.full.js"></script>

    <!-- Custom Annotation System -->
    <script src="lib/annotation.js"></script>
</body>
</html>
